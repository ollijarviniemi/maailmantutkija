{
  "meta": {
    "id": "comprehensive-test",
    "title": "Comprehensive Component Test Level",
    "description": "Tests all revised components: Observation (5Ã—5 grid), Filter (custom color/sides), Shuffler (dual output + retention), Duplicator (multi-output), Conveyor-turn, Merger",
    "bettingConfig": {
      "granularity": 20
    }
  },
  "grid": {
    "width": 12,
    "height": 10
  },
  "components": [
    {
      "id": 1,
      "type": "sack",
      "position": {"x": 1, "y": 1},
      "params": {
        "color": "red",
        "direction": "right"
      }
    },
    {
      "id": 2,
      "type": "conveyor",
      "position": {"x": 2, "y": 1},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 3,
      "type": "duplicator",
      "position": {"x": 3, "y": 1},
      "params": {
        "copies": 6,
        "outputPattern": [
          {"side": "right", "count": 3},
          {"side": "down", "count": 2},
          {"side": "up", "count": 1}
        ],
        "plex": false,
        "outputDelay": 500
      }
    },
    {
      "id": 4,
      "type": "conveyor",
      "position": {"x": 4, "y": 1},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 5,
      "type": "observation",
      "position": {"x": 5, "y": 1},
      "params": {
        "label": "Top Path",
        "ballScale": 0.15
      }
    },
    {
      "id": 6,
      "type": "conveyor",
      "position": {"x": 3, "y": 2},
      "params": {
        "direction": "down"
      }
    },
    {
      "id": 7,
      "type": "shuffler",
      "position": {"x": 3, "y": 3},
      "params": {
        "numInputs": 2,
        "input1Side": "up",
        "input2Side": "left",
        "minBufferSize": 5,
        "outputPattern": [
          {"side": "right", "count": 2},
          {"side": "down", "count": 1},
          {"retain": true, "count": 2}
        ],
        "outputDelay": 800
      }
    },
    {
      "id": 8,
      "type": "conveyor",
      "position": {"x": 2, "y": 3},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 9,
      "type": "conveyor-turn",
      "position": {"x": 2, "y": 2},
      "params": {
        "turnType": "down-to-right"
      }
    },
    {
      "id": 10,
      "type": "conveyor",
      "position": {"x": 4, "y": 3},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 11,
      "type": "filter",
      "position": {"x": 5, "y": 3},
      "params": {
        "capacity": 3,
        "targetColor": "red",
        "direction": "left",
        "matchOutputSide": "left",
        "nonMatchOutputSide": "right",
        "plex": false,
        "outputDelay": 500
      }
    },
    {
      "id": 12,
      "type": "observation",
      "position": {"x": 6, "y": 3},
      "params": {
        "label": "Non-Match",
        "ballScale": 0.15
      }
    },
    {
      "id": 13,
      "type": "conveyor",
      "position": {"x": 3, "y": 4},
      "params": {
        "direction": "down"
      }
    },
    {
      "id": 14,
      "type": "merger",
      "position": {"x": 3, "y": 5},
      "params": {
        "direction": "down"
      }
    },
    {
      "id": 15,
      "type": "conveyor",
      "position": {"x": 4, "y": 5},
      "params": {
        "direction": "left"
      }
    },
    {
      "id": 16,
      "type": "conveyor-turn",
      "position": {"x": 4, "y": 4},
      "params": {
        "turnType": "right-to-down"
      }
    },
    {
      "id": 17,
      "type": "conveyor",
      "position": {"x": 5, "y": 4},
      "params": {
        "direction": "left"
      }
    },
    {
      "id": 18,
      "type": "conveyor",
      "position": {"x": 3, "y": 6},
      "params": {
        "direction": "down"
      }
    },
    {
      "id": 19,
      "type": "observation",
      "position": {"x": 3, "y": 7},
      "params": {
        "label": "Final Mixed",
        "ballScale": 0.15
      }
    },
    {
      "id": 20,
      "type": "sack",
      "position": {"x": 1, "y": 5},
      "params": {
        "color": "blue",
        "direction": "right"
      }
    },
    {
      "id": 21,
      "type": "conveyor",
      "position": {"x": 2, "y": 5},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 22,
      "type": "conveyor",
      "position": {"x": 3, "y": 0},
      "params": {
        "direction": "right"
      }
    },
    {
      "id": 23,
      "type": "black-pit",
      "position": {"x": 4, "y": 0},
      "params": {}
    }
  ],
  "connections": [
    {"from": 1, "to": 2},
    {"from": 2, "to": 3},
    {"from": 3, "to": 4, "fromPort": "right"},
    {"from": 4, "to": 5},
    {"from": 3, "to": 6, "fromPort": "down"},
    {"from": 6, "to": 7},
    {"from": 9, "to": 8},
    {"from": 8, "to": 7},
    {"from": 7, "to": 10, "fromPort": "right"},
    {"from": 10, "to": 11},
    {"from": 11, "to": 12, "fromPort": "right"},
    {"from": 7, "to": 13, "fromPort": "down"},
    {"from": 13, "to": 14},
    {"from": 17, "to": 16},
    {"from": 16, "to": 15},
    {"from": 15, "to": 14},
    {"from": 14, "to": 18},
    {"from": 18, "to": 19},
    {"from": 20, "to": 21},
    {"from": 21, "to": 14},
    {"from": 3, "to": 22, "fromPort": "up"},
    {"from": 22, "to": 23},
    {"from": 11, "to": 17, "fromPort": "left"}
  ],
  "hypothesisSpace": {
    "type": "independent",
    "components": {
      "1": {
        "alternatives": [
          {"color": "red"},
          {"color": "blue"}
        ]
      },
      "20": {
        "alternatives": [
          {"color": "red"},
          {"color": "blue"}
        ]
      }
    }
  },
  "hypothesisScript": "// Test hypothesis space\n// Two sacks (red vs blue)\n\nsack(1, [\n  {color: 'red'},\n  {color: 'blue'}\n]);\n\nsack(20, [\n  {color: 'red'},\n  {color: 'blue'}\n]);\n\nbuckets(20);",
  "samplingSchedule": null,
  "simulation": {
    "ballProductionInterval": 2000,
    "ballSpeed": 1.0,
    "ballsToSpawn": 30,
    "seed": 42
  }
}
