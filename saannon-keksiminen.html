<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Säännön keksiminen - Maailmantutkija</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: white;
            font-family: Arial, sans-serif;
            overflow-x: hidden;
        }

        #rule-discovery-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        #help-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 30px;
            height: 30px;
            border: 2px solid #666;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            background-color: white;
            transition: all 0.2s ease;
            z-index: 1000;
        }

        #help-icon:hover {
            background-color: #f5f5f5;
            border-color: #333;
            color: #333;
        }

        #help-tooltip {
            position: absolute;
            top: 40px;
            right: 0;
            background-color: #333;
            color: white;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.4;
            display: none;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            width: 350px;
            white-space: normal;
        }

        #help-tooltip::before {
            content: '';
            position: absolute;
            top: -6px;
            right: 15px;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 6px solid #333;
        }

        /* Main menu layout */
        .game-list {
            width: 100%;
            max-width: 1300px;
            margin-top: 60px;
        }

        .game-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 15px 0;
        }

        .game-name {
            width: 280px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .game-help-icon {
            width: 18px;
            height: 18px;
            border: 1.5px solid #666;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #666;
            cursor: pointer;
            background-color: white;
            transition: all 0.2s ease;
            flex-shrink: 0;
            position: relative;
        }

        .game-help-icon:hover {
            background-color: #f5f5f5;
            border-color: #333;
            color: #333;
        }

        .game-help-tooltip {
            position: absolute;
            top: -10px;
            left: 30px;
            background-color: #333;
            color: white;
            padding: 10px 12px;
            border-radius: 6px;
            font-size: 13px;
            line-height: 1.4;
            display: none;
            z-index: 1000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            width: 300px;
            white-space: normal;
            font-weight: normal;
        }

        .game-help-icon:hover .game-help-tooltip {
            display: block;
        }

        .game-help-tooltip::before {
            content: '';
            position: absolute;
            top: 15px;
            left: -6px;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 6px solid #333;
        }

        .rounds-grid {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            flex: 1;
        }

        .round-box {
            width: 38px;
            height: 38px;
            border: 2px solid #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: bold;
            background: white;
            color: #666;
            transition: all 0.2s ease;
        }

        .round-box:hover {
            background: #e3f2fd;
            border-color: #2196F3;
            color: #1976d2;
            transform: scale(1.1);
        }

        .round-box.completed {
            background: #4caf50;
            border-color: #4caf50;
            color: white;
        }

        .round-box.completed:hover {
            background: #45a049;
            border-color: #388e3c;
            transform: scale(1.1);
        }

        /* Game screen layout */
        #game-screen {
            display: none;
            width: 100%;
            max-width: 1400px;
            margin-top: 60px;
        }

        #game-screen.active {
            display: block;
        }

        .back-button {
            display: inline-block;
            padding: 8px 16px;
            background-color: #f5f5f5;
            color: #666;
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            border: 1px solid #ddd;
            transition: all 0.2s ease;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .back-button:hover {
            background-color: #e0e0e0;
            color: #333;
        }

        .game-layout {
            display: flex;
            gap: 20px;
        }

        .game-main {
            flex: 1;
            min-width: 0;
        }

        .game-history {
            width: 450px;
            flex-shrink: 0;
        }

        .game-header {
            font-size: 22px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .round-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
        }

        #example-display {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
        }

        #shape-canvas {
            border-radius: 8px;
            max-width: 100%;
        }

        .shapes-row {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .shape-box {
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .shape-box canvas {
            width: 80px;
            height: 80px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 15px;
        }

        .btn {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-yes {
            background-color: #4caf50;
            color: white;
        }

        .btn-yes:hover {
            background-color: #45a049;
        }

        .btn-no {
            background-color: #f44336;
            color: white;
        }

        .btn-no:hover {
            background-color: #da190b;
        }

        .btn-primary {
            background-color: #2196F3;
            color: white;
        }

        .btn-primary:hover {
            background-color: #0b7dda;
        }

        .btn-secondary {
            background-color: #9e9e9e;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #757575;
        }

        /* History panel */
        .history-panel {
            background: white;
            padding: 15px;
            max-height: 600px;
            overflow-y: auto;
        }

        .history-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .history-item {
            background: white;
            padding: 10px 0;
            margin-bottom: 8px;
            font-size: 13px;
            border-bottom: 1px solid #eee;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .history-shapes {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
        }

        .history-shape-mini {
            width: 30px;
            height: 30px;
        }

        .history-result {
            font-size: 12px;
            color: #666;
        }

        .correct-answer {
            color: #4caf50;
            font-weight: bold;
        }

        .incorrect-answer {
            color: #f44336;
            font-weight: bold;
        }

        /* Function machine UI */
        .function-machine-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 20px;
        }

        .function-test-row {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 12px;
            font-size: 20px;
        }

        .function-input-box, .function-output-box {
            min-width: 80px;
            text-align: center;
            font-weight: bold;
            font-family: monospace;
        }

        .function-input-box input {
            width: 80px;
            height: 50px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-weight: bold;
            -moz-appearance: textfield;
        }

        .function-input-box input::-webkit-outer-spin-button,
        .function-input-box input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .function-f-box {
            width: 60px;
            height: 60px;
            border: 3px solid #2196F3;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: #2196F3;
        }

        .function-arrow {
            font-size: 28px;
            color: #999;
        }

        .function-prediction-row {
            display: flex;
            align-items: center;
            gap: 20px;
            background: #fffacd;
            padding: 12px 20px;
            border-radius: 6px;
            margin: 10px 0;
        }

        .function-prediction-input {
            width: 80px;
            height: 40px;
            font-size: 20px;
            text-align: center;
            border: 2px solid #ffd700;
            border-radius: 6px;
            font-weight: bold;
            -moz-appearance: textfield;
        }

        .function-prediction-input::-webkit-outer-spin-button,
        .function-prediction-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Sequence UI */
        .sequence-input-row {
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: flex-start;
            margin: 20px 0;
        }

        .sequence-number {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            min-width: 50px;
            text-align: center;
            padding: 12px 18px;
            border: 2px solid #ddd;
            border-radius: 6px;
            background-color: #f9f9f9;
        }

        .sequence-input {
            width: 100px;
            padding: 12px 18px;
            font-size: 24px;
            text-align: center;
            border: 3px solid #2196F3;
            border-radius: 6px;
            font-weight: bold;
            -moz-appearance: textfield;
        }

        .sequence-input::-webkit-outer-spin-button,
        .sequence-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .sequence-input:focus {
            outline: none;
            border-color: #0b7dda;
        }

        .sequence-input.correct {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .sequence-input.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        .sequence-comma {
            font-size: 28px;
            color: #999;
        }

        /* Three numbers game */
        .three-numbers-display {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .number-input {
            width: 150px;
            height: 60px;
            font-size: 32px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-weight: bold;
            -moz-appearance: textfield;
        }

        .number-input::-webkit-outer-spin-button,
        .number-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .three-numbers-history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 6px;
            font-family: monospace;
        }

        .feedback {
            text-align: center;
            font-size: 18px;
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            display: none;
            font-weight: 500;
        }

        .feedback.correct {
            color: #2e7d32;
            display: block;
        }

        .feedback.incorrect {
            color: #c62828;
            display: block;
        }

        .feedback.neutral {
            color: #666;
            display: block;
        }

        .feedback.info {
            color: #1565c0;
            display: block;
        }

        .reset-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .reset-button:hover {
            background-color: #da190b;
        }

        .hidden {
            display: none !important;
        }

        .success-message {
            text-align: center;
            padding: 40px;
            font-size: 24px;
            color: #2e7d32;
        }

        @media (max-width: 1200px) {
            .game-layout {
                flex-direction: column;
            }

            .game-history {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .game-name {
                width: 150px;
                font-size: 14px;
            }

            .round-box {
                width: 35px;
                height: 35px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div id="rule-discovery-container">
        <div id="help-icon">
            ?
            <div id="help-tooltip">
                Sivulle on koottu kahdeksan eri peliä, joissa on yhteensä 90 kierrosta. Pelaajan tehtävänä on keksiä säännönmukaisuus. Joissakin peleissä pelaaja painaa "kyllä"- ja "ei"-nappeja ja läpäisee kierroksen saatuaan riittävän monta esimerkkiä peräkkäin oikein. Joissakin peleissä pelaajan tulee esimerkkien kautta selvittää sääntö ja sitten vastata oikein esimerkkitapauksiin, jotka testaavat, onko hän löytänyt oikean säännön.
            </div>
        </div>

        <div id="main-menu" class="game-list">
            <div class="game-row" data-game="shapes">
                <div class="game-name">
                    <span>1. Värikkäät muodot</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Näet neljä kuviota, joista jokaisella on väri ja muoto. Jotkin kuvioiden sarjat noudattavat salaista sääntöä ja jotkin eivät. Tehtävänäsi on selvittää tämä sääntö ja sanoa kullekin sarjalle, toteuttavaako se säännön vai ei. Läpäiset kierroksen vastattuasi putkeen 10 kertaa oikein.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="shapes-rounds"></div>
            </div>

            <div class="game-row" data-game="grids">
                <div class="game-name">
                    <span>2. Ruudukot</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Näet 6×6-ruudukon, jossa jotkin ruuduista ovat mustia. Kullakin kierroksella jotkin ruudukoista toteuttavat säännön ja jotkin eivät. Läpäiset kierroksen vastattuasi putkeen 15 kertaa oikein.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="grids-rounds"></div>
            </div>

            <div class="game-row" data-game="points">
                <div class="game-name">
                    <span>3. Pisteet tasossa</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Näet ruudukkoon aseteltuja pisteitä. Jälleen on olemassa jokin sääntö, jonka jotkin pisteasetelmat toteuttavat ja jotkin eivät. Läpäiset kierroksen lajiteltuasi 15 asetelmaa peräkkäin oikein.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="points-rounds"></div>
            </div>

            <div class="game-row" data-game="sequences">
                <div class="game-name">
                    <span>4. Lukujonot</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Näet lukujonon ensimmäiset luvut. Tehtäväsi on keksiä sääntö, joka määrittää, miten jono jatkuu. Anna seuraava luku jonossa, kunnes saat kaksi peräkkäin oikein.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="sequences-rounds"></div>
            </div>

            <div class="game-row" data-game="threeNumbers">
                <div class="game-name">
                    <span>5. Kolmen luvun peli</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Jokaisella kierroksella on jokin sääntö, jonka jotkin lukukolmikot toteuttavat. Sinulle annetaan yksi esimerkki lukukolmikosta, joka toteuttaa säännön. Voit sitten kokeilla muita lukukolmikoita ja selvittää, toteuttavatko ne säännön vai ei. Kun olet valmis, voit kirjoittaa sääntösi tekstikenttään ja edetä testivaiheeseen. Testivaiheessa sinun täytyy luokitella kymmenen lukukolmikkoa oikein. Tähtää testivaiheen läpäisemiseen aina ensimmäisellä yrityksellä!</div>
                    </div>
                </div>
                <div class="rounds-grid" id="threeNumbers-rounds"></div>
            </div>

            <div class="game-row" data-game="functions">
                <div class="game-name">
                    <span>6. Funktiokoneet</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Näet "koneen", joka ottaa sisään yhden luvun ja palauttaa toisen luvun. Tehtäväsi on keksiä, mitä sääntöä kone noudattaa. Voit testata koneen toimintaa eri luvuilla. Kun olet valmis, voit edellisen pelin tapaan kirjoittaa säännön tekstikenttään ja edetä testivaiheeseen. Pyri pääsemään testivaiheesta läpi ensimmäisellä yrityksellä!</div>
                    </div>
                </div>
                <div class="rounds-grid" id="functions-rounds"></div>
            </div>

            <div class="game-row" data-game="functions2">
                <div class="game-name">
                    <span>7. Funktiokoneet, osa 2</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Samoin kuin edellisessä pelissä, mutta nyt kone ottaa sisään kaksi lukua ja antaa ulos yhden luvun. Tehtävänäsi on jälleen kokeilemalla selvittää, mitä sääntöä kone noudattaa.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="functions2-rounds"></div>
            </div>

            <div class="game-row" data-game="functions5">
                <div class="game-name">
                    <span>8. Funktiokoneet, osa 3</span>
                    <div class="game-help-icon">
                        ?
                        <div class="game-help-tooltip">Samoin kuin kahdessa edellisessä pelissä, mutta nyt kone ottaa sisään viisi lukua ja antaa ulos yhden luvun.</div>
                    </div>
                </div>
                <div class="rounds-grid" id="functions5-rounds"></div>
            </div>

            <button class="reset-button" id="reset-all">Nollaa kaikki tiedot</button>
        </div>

        <div id="game-screen">
            <button class="back-button" id="back-to-menu">← Takaisin päävalikkoon</button>

            <div class="game-layout">
                <div class="game-main">
                    <div class="game-header" id="game-title"></div>
                    <div class="round-info" id="round-info"></div>

                    <div id="example-display"></div>

                    <div id="controls"></div>

                    <div class="feedback" id="feedback"></div>
                </div>

                <div class="game-history hidden" id="history-column">
                    <div class="history-panel">
                        <div class="history-title">Historia</div>
                        <div id="history-content"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/assets/js/shape-generator-client.js"></script>
    <script type="module">
        import { RuleDiscoveryApp } from '/assets/js/rule-discovery/core/app-manager.js';

        // Initialize the application when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            window.ruleDiscoveryApp = new RuleDiscoveryApp();
        });
    </script>
</body>
</html>
